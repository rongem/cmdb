<app-help>
    <p i18n="the new configuration items will have connections to those configuration items, to which the attributes have belonged">
        Die neuen Configuration Items werden mit den Configuration Items verbunden, 
        deren Attribute sie bislang waren.
    </p>
    <p i18n="While converting an attribute type into a configuration item type, identical attribute values will be merged into one configuration item. So if you have five attributes with the value 'X', you will afterwards have only one item with the name 'X' that will be connected to five configuration items.">
        Beim Umwandeln eines Attribut-Typen in einen Configuration Item Typen werden 
        identische Attributwerte zu einem Configuration Item zusammengefasst.
        Folglich wird auf 5 Attributen mit dem Wert 'X' nur ein Configuration Item mit
        dem Namen 'X', das mit den 5 bisherigen Configuration Items,
        die das Attribut besa&szlig;en, verbunden sind.
    </p>
    <p i18n="you may take additional attributes from the old configuration item to the new one, if their values are consistent with the converted attribute values. If you have an attribute of type 'model' with the value 'Y' and the attribute of type 'manufacturer' is always 'Z' for that, you can take the 'manufacturer' attribute to the new 'model' item type. Existing attributes of type 'manufacturer' will be deleted in that case.">
        Weiterhin k&ouml;nnen zus&auml;tzliche Attribute zum neuen Configuration Item mitgenommen 
        werden, sofern ihre Werte konsistent mit den zu &uuml;bertragenden 
        Attributwerten &uuml;bereinstimmen. Lautet also zu einem Attribut vom Typ 'Modell' 
        der Wert 'Y', und beim zugeh&ouml;rigen Attribut 'Hersteller'
        der Wert immer 'Z', so kann das Attribut 'Hersteller' als Attribut zum neuen 
        Configuration Item-Typ 'Modell' mitgenommen werden.
        Bei den bisherigen Configuration Items wird dann das Attribut 'Hersteller' entfernt.
    </p>
    <p i18n="depending on the number of attribute values to be converted, this operation may take multiple minutes.">
        Je nach der zu verarbeitenden Datenmenge kann die Operation mehrere Minuten dauern.
    </p>
</app-help>
<div class="container">
    <div class="table-cell">
        <h3 i18n="converting attribute type to item type">
            Konvertieren des Attributtyps {{ attributeTypeToConvert?.TypeName }} zu einem Item-Typen
        </h3>
    </div>
    <div class="table-cell">
        <div class="flex" [ngClass]="{ backward: newPosition === 'above' }">
            <div class="item-type">
                <p i18n="existing item types">
                    Bisherige Item-Typen
                </p>
                <mat-selection-list [(ngModel)]="transferAttributeTypes"
                    i18n-matTooltip="attribute types to be transferred from the old item to the new item type created from the attribute type"
                    matTooltip="Attribut-Typen, die vom alten Item zum aus dem Attribut-Typ neu erstellten Item-Typ transferiert werden sollen">
                    <mat-list-option class="strikethrough" disabled="true">
                        {{ attributeTypeToConvert.TypeName }}
                    </mat-list-option>
                    <mat-list-option *ngFor="let transferrableAttributeType of (transferrableAttributeTypes | async)"
                        [value]="transferrableAttributeType.TypeId">
                        {{ transferrableAttributeType.TypeName }}
                    </mat-list-option>
                </mat-selection-list>
            </div>
            <div class="rule__connection-button"
                (click)="ngOnInit()">
                <select id="newconnection" [(ngModel)]="newConnectionType" (loadeddata)="log($event)">
                    <option *ngFor="let connectionType of (meta | async).connectionTypes"
                        [value]="connectionType.ConnTypeId">
                        {{ newPosition === 'above' ? connectionType.ConnTypeName : connectionType.ConnTypeReverseName }}
                    </option>
                </select>
                <span class="material-icons">arrow_downward</span>
                <span>&nbsp;&nbsp;</span>
                <button mat-button type="button" (click)="toggleDirection()">
                    <span class="material-icons">loop</span>
                </button>
                <span>&nbsp;&nbsp;</span>
                <span class="material-icons">arrow_upward</span>
                <span>
                    {{ newPosition === 'above' ? (meta | async).connectionTypesMap.get(newConnectionType)?.ConnTypeReverseName : (meta | async).connectionTypesMap.get(newConnectionType)?.ConnTypeName }}
                </span>
            </div>
            <div class="item-type" [style.background]="newColor">
                <div class="text-on-background" [ngClass]="{ strikethrough: !!itemType && conversionMethod === 'rename' }">
                    <span>{{ attributeTypeToConvert?.TypeName }}</span>
                    <button mat-icon-button *ngIf="itemType" (click)="toggleConversion()">
                        <span matTooltip="Es existiert bereits ein Item-Type mit diesem Namen. Die neuen Configuration Items sollen dem existierenden Typ hinzugefügt werden."
                            i18n-matTooltip="An item type with that name already exists. Merge the new configuration items into the existing item type."
                            class="material-icons" *ngIf="conversionMethod === 'merge'">call_merge</span>
                        <span matTooltip="Es existiert bereits ein Item-Type mit diesem Namen. Deshalb wird ein neuer Item-Typ mit dem angegebenen Namen erzeugt."
                            i18n-matTooltip="An item type with that name already exists. Create a new item type with a new name."
                            class="material-icons" *ngIf="conversionMethod === 'rename'">call_split</span>
                    </button>
                    <span *ngIf="conversionMethod === 'rename'">
                        <label for="newname" i18n="new name for the item type">
                            Neuer Name für den Item-Typ
                        </label>
                        <input type="text" id="newname" name="newname" [(ngModel)]="newName" />
                    </span>
                </div>
                <div>
                    <label for="color" i18n="item type background color">
                            Hintergrundfarbe des Item-Typs
                    </label>
                    <input [colorPicker]="itemType?.TypeBackColor"
                        [style.background]="itemType?.TypeBackColor"
                        class="insecure-background"
                        [cpOutputFormat]="'hex'"
                        [cpPosition]="'bottom'"
                        [cpSaveClickOutside]="false"
                        [cpOKButton]="true" [cpCancelButton]="true"
                        [(ngModel)]="newColor"
                        [disabled]="!!itemType && conversionMethod === 'merge'"
                        [value]="itemType?.TypeBackColor" />
                </div>
            </div>
                
        </div>
    </div>
    <div class="table-cell">
    </div>
    <div class="table-cell">
        <button mat-button type="button" i18n="start converting">Umwandlung starten</button>
    </div>
</div>
