<div class="container two-rows">
    <div class="table-cell table-header" i18n="connection rule">Verbindungsregel</div>
    <div class="table-cell table-header" i18n="commands">Befehle</div>
    <ng-container *ngFor="let rule of (meta | async).connectionRules">
        <div class="table-cell">
            <div class="rule-container">
                <div class="rule__item-type" [style.background]="(meta | async).itemTypesMap.get(rule.ItemUpperType)?.TypeBackColor">
                    <label class="text-on-background" type="button">
                        {{ (meta | async).itemTypesMap.get(rule.ItemUpperType)?.TypeName }}
                    </label>
                </div>
                <button mat-button class="rule__connection-button"
                    (click)="onSetRule(rule)"
                    *ngIf="rule.RuleId!==activeRule">
                    <span>
                        {{ (meta | async).connectionTypesMap.get(rule.ConnType)?.ConnTypeName }}
                        (&le; {{ rule.MaxConnectionsToLower }})
                    </span>
                    <span class="material-icons">arrow_downward</span>
                    <span>&nbsp;&nbsp;</span>
                    <span class="material-icons">arrow_upward</span>
                    <span>
                            {{ (meta | async).connectionTypesMap.get(rule.ConnType)?.ConnTypeReverseName }}
                            (&le; {{ rule.MaxConnectionsToUpper }})
                    </span>
                </button>
                <div mat-button class="rule__connection-edit"
                    (click)="onSetRule(rule)"
                    *ngIf="rule.RuleId===activeRule">
                    <span>
                        {{ (meta | async).connectionTypesMap.get(rule.ConnType)?.ConnTypeName }}
                        (&le;
                        <input mat-input type="number" autofocus required [value]="rule.MaxConnectionsToLower" #mcl
                            min="1" max="9999" />
                        )
                    </span>
                    <span class="material-icons">arrow_downward</span>
                    <span>&nbsp;&nbsp;</span>
                    <span class="material-icons">arrow_upward</span>
                    <span>
                            {{ (meta | async).connectionTypesMap.get(rule.ConnType)?.ConnTypeReverseName }}
                            (&le; 
                            <input mat-input type="number" required [value]="rule.MaxConnectionsToUpper" #mcu
                                min="1" max="9999" />
                            )
                    </span>
                    <button class="btn-ok" mat-icon-button type="button"
                        [disabled]="isDataInvalidOrUnchanged(mcl.value, mcu.value)"
                        matTooltip="Speichern" i18n-matTooltip="save"
                        (click)="onChangeRule(rule, +mcl.value, +mcu.value)">
                        <span class="material-icons">done</span>
                    </button>
                    <button class="btn-cancel" mat-icon-button type="button" (click)="onCancel()"
                        matTooltip="Abbrechen" i18n-matTooltip="cancel">
                        <span class="material-icons">block</span>
                    </button>
                </div>
                <div class="rule__item-type" [style.background]="(meta | async).itemTypesMap.get(rule.ItemLowerType)?.TypeBackColor">
                    <label class="text-on-background" type="button">
                        {{ (meta | async).itemTypesMap.get(rule.ItemLowerType)?.TypeName }}
                    </label>
                </div>
            </div>
        </div>
        <div class="table-cell">
            <button mat-icon-button type="button"
                    ngxClipboard [cbContent]="rule.RuleId"
                    matTooltip="Guid in die Zwischenablage kopieren"
                    i18n-matTooltip="copy guid to clipboard">
                    <span class="material-icons">shop_two</span>
            </button>
        </div>
    </ng-container>  
</div>